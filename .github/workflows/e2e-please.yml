name: E2E Please

on:
    workflow_call:
        inputs:
            github_ref:
                description: The git ref to check out; will use the tag_name if not provided
                type: string
                required: false
            developer-developer-service-tag:
                type: string
                description: The Tag to use for the Developer Service Docker image
                required: false

        secrets:
            HEDIA_BOT_GITHUB_PAT:
                description: Needed to push to GitHub Container Registry
                required: true

permissions:
    contents: write
    pull-requests: write
    packages: write

jobs:
    dockerize-please:
        runs-on: ubuntu-latest
        timeout-minutes: 10
        steps:
            - name: Run E2E Test Workflow
              run: |
                  gh workflow run --repo hedia-team/e2e-service --raw-field suite="All" --raw-field developer-service-tag=${{ inputs.developer-service-tag }} test-please.yml
              env:
                  GH_TOKEN: ${{ secrets.HEDIA_BOT_GITHUB_PAT }}
